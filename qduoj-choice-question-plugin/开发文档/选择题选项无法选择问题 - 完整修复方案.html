<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é€‰æ‹©é¢˜é€‰é¡¹æ— æ³•é€‰æ‹©é—®é¢˜ä¿®å¤</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        h2 {
            color: #555;
            margin-top: 30px;
            border-left: 4px solid #764ba2;
            padding-left: 10px;
        }
        .problem-section {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .solution-section {
            background: #d4edda;
            border: 2px solid #28a745;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .code-block {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 15px;
            margin: 15px 0;
            overflow-x: auto;
            position: relative;
        }
        .code-block pre {
            margin: 0;
            font-family: 'Courier New', Courier, monospace;
            font-size: 14px;
            line-height: 1.5;
        }
        .file-path {
            background: #007bff;
            color: white;
            padding: 5px 10px;
            border-radius: 4px 4px 0 0;
            display: inline-block;
            margin-bottom: -1px;
            font-size: 12px;
            font-weight: bold;
        }
        .important {
            background: #ffebee;
            border-left: 4px solid #f44336;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        .step {
            background: #f5f5f5;
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            border-left: 5px solid #667eea;
        }
        .step-number {
            display: inline-block;
            background: #667eea;
            color: white;
            width: 30px;
            height: 30px;
            line-height: 30px;
            text-align: center;
            border-radius: 50%;
            margin-right: 10px;
            font-weight: bold;
        }
        ul {
            line-height: 1.8;
        }
        .highlight {
            background: yellow;
            padding: 2px 4px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ é€‰æ‹©é¢˜é€‰é¡¹æ— æ³•é€‰æ‹©é—®é¢˜ - å®Œæ•´ä¿®å¤æ–¹æ¡ˆ</h1>
        
        <div class="problem-section">
            <h2>ğŸš¨ é—®é¢˜æè¿°</h2>
            <p><strong>ç”¨æˆ·åé¦ˆï¼š</strong>åœ¨é¢˜ç›®12ä¸­ï¼Œå½“é€‰é¡¹åŒ…å«æ•°å­¦å…¬å¼å’ŒC++ä»£ç æ—¶ï¼Œæ— æ³•ç‚¹å‡»é€‰æ‹©é€‰é¡¹ï¼Œå¯¼è‡´æ— æ³•ç­”é¢˜ã€‚</p>
            <p><strong>é—®é¢˜URLï¼š</strong> http://localhost:8080/choice-question/12</p>
            <p><strong>ç—‡çŠ¶ï¼š</strong></p>
            <ul>
                <li>ç‚¹å‡»é€‰é¡¹æ—¶ï¼ŒRadio/Checkboxç»„ä»¶ä¸å“åº”</li>
                <li>é€‰é¡¹å†…å®¹ï¼ˆç‰¹åˆ«æ˜¯KaTeXå…¬å¼å’Œä»£ç å—ï¼‰é˜»æ­¢äº†ç‚¹å‡»äº‹ä»¶</li>
                <li>ç”¨æˆ·æ— æ³•é€‰æ‹©ç­”æ¡ˆï¼Œæ— æ³•æäº¤</li>
            </ul>
        </div>

        <div class="important">
            <h3>âš ï¸ æ ¹æœ¬åŸå› åˆ†æ</h3>
            <p>KaTeXæ¸²æŸ“çš„æ•°å­¦å…¬å¼å’Œä»£ç é«˜äº®ç»„ä»¶ä¼šåˆ›å»ºå¤æ‚çš„DOMç»“æ„ï¼Œè¿™äº›å…ƒç´ å¯èƒ½ï¼š</p>
            <ol>
                <li>è¦†ç›–äº†Radio/Checkboxçš„ç‚¹å‡»åŒºåŸŸ</li>
                <li>æ‹¦æˆªäº†ç‚¹å‡»äº‹ä»¶ï¼Œé˜»æ­¢äº‹ä»¶å†’æ³¡åˆ°çˆ¶å…ƒç´ </li>
                <li>z-indexå±‚çº§é—®é¢˜å¯¼è‡´é€‰é¡¹ä¸å¯ç‚¹å‡»</li>
            </ol>
        </div>

        <div class="solution-section">
            <h2>âœ… å®Œæ•´ä¿®å¤æ–¹æ¡ˆ</h2>
            
            <div class="step">
                <span class="step-number">1</span>
                <strong>ä¿®æ”¹ ChoiceQuestionDetail.vue - æ¨¡æ¿éƒ¨åˆ†</strong>
            </div>
            
            <div class="file-path">OnlineJudgeFE/src/pages/oj/views/choice-question/ChoiceQuestionDetail.vue</div>
            <div class="code-block">
                <pre>&lt;!-- ä¿®æ”¹é€‰é¡¹åŒºåŸŸçš„æ¨¡æ¿ --&gt;
&lt;!-- å•é€‰é¢˜ --&gt;
&lt;el-radio-group v-if="!problem.multiple_choice" 
                v-model="result.answer"
                class="choice-options"&gt;
  &lt;el-radio v-for="option in problem.options" 
            :key="option.key"
            :label="option.key"
            class="option-item"
            @click.native="handleOptionClick(option.key, false)"&gt;
    &lt;div class="option-wrapper"&gt;
      &lt;span class="option-key"&gt;{{ option.key }}.&lt;/span&gt;
      &lt;div class="option-content" 
           v-html="option.content"
           @click.stop.prevent="handleContentClick(option.key, false)"&gt;&lt;/div&gt;
    &lt;/div&gt;
  &lt;/el-radio&gt;
&lt;/el-radio-group&gt;

&lt;!-- å¤šé€‰é¢˜ --&gt;
&lt;el-checkbox-group v-else 
                   v-model="result.answer"
                   class="choice-options"&gt;
  &lt;el-checkbox v-for="option in problem.options" 
               :key="option.key"
               :label="option.key"
               class="option-item"
               @click.native="handleOptionClick(option.key, true)"&gt;
    &lt;div class="option-wrapper"&gt;
      &lt;span class="option-key"&gt;{{ option.key }}.&lt;/span&gt;
      &lt;div class="option-content" 
           v-html="option.content"
           @click.stop.prevent="handleContentClick(option.key, true)"&gt;&lt;/div&gt;
    &lt;/div&gt;
  &lt;/el-checkbox&gt;
&lt;/el-checkbox-group&gt;</pre>
            </div>

            <div class="step">
                <span class="step-number">2</span>
                <strong>æ·»åŠ äº‹ä»¶å¤„ç†æ–¹æ³•</strong>
            </div>
            
            <div class="code-block">
                <pre>// åœ¨ methods ä¸­æ·»åŠ ä»¥ä¸‹æ–¹æ³•
methods: {
  // å¤„ç†é€‰é¡¹ç‚¹å‡»ï¼ˆåŒ…æ‹¬Radio/Checkboxæœ¬èº«ï¼‰
  handleOptionClick(key, isMultiple) {
    if (this.submissionId || this.result.result) {
      return; // å·²æäº¤ï¼Œä¸å…è®¸ä¿®æ”¹
    }
    
    // ä½¿ç”¨ nextTick ç¡®ä¿ DOM æ›´æ–°åå†å¤„ç†
    this.$nextTick(() => {
      if (!isMultiple) {
        // å•é€‰é¢˜ï¼šç›´æ¥è®¾ç½®ç­”æ¡ˆ
        if (this.result.answer !== key) {
          this.result.answer = key;
        }
      } else {
        // å¤šé€‰é¢˜ï¼šåˆ‡æ¢é€‰ä¸­çŠ¶æ€
        const index = this.result.answer.indexOf(key);
        if (index === -1) {
          this.result.answer.push(key);
        } else {
          this.result.answer.splice(index, 1);
        }
      }
    });
  },
  
  // å¤„ç†é€‰é¡¹å†…å®¹åŒºåŸŸç‚¹å‡»
  handleContentClick(key, isMultiple) {
    if (this.submissionId || this.result.result) {
      return; // å·²æäº¤ï¼Œä¸å…è®¸ä¿®æ”¹
    }
    
    // é˜»æ­¢äº‹ä»¶å†’æ³¡ï¼Œç„¶åæ‰‹åŠ¨è§¦å‘é€‰æ‹©
    if (!isMultiple) {
      // å•é€‰é¢˜
      this.result.answer = key;
    } else {
      // å¤šé€‰é¢˜
      const index = this.result.answer.indexOf(key);
      if (index === -1) {
        this.result.answer.push(key);
      } else {
        this.result.answer.splice(index, 1);
      }
    }
    
    // å¼ºåˆ¶æ›´æ–°è§†å›¾
    this.$forceUpdate();
  },
  
  // ... å…¶ä»–ç°æœ‰æ–¹æ³•
}</pre>
            </div>

            <div class="step">
                <span class="step-number">3</span>
                <strong>å…³é”®CSSæ ·å¼ä¿®å¤</strong>
            </div>
            
            <div class="code-block">
                <pre>&lt;style scoped&gt;
/* é€‰é¡¹å®¹å™¨æ ·å¼ */
.choice-options {
  width: 100%;
}

.option-item {
  display: block;
  margin-bottom: 15px;
  width: 100%;
  position: relative;
}

/* é€‰é¡¹åŒ…è£…å™¨ - ç¡®ä¿å¯ç‚¹å‡» */
.option-wrapper {
  display: flex;
  align-items: flex-start;
  cursor: pointer;
  padding: 12px 15px;
  background: #f8f9fa;
  border-radius: 8px;
  transition: all 0.3s ease;
  position: relative;
  /* ç¡®ä¿æ•´ä¸ªåŒºåŸŸå¯ç‚¹å‡» */
  pointer-events: auto !important;
}

.option-wrapper:hover {
  background: #e9ecef;
  transform: translateX(5px);
}

/* é€‰é¡¹é”®æ ·å¼ */
.option-key {
  font-weight: bold;
  margin-right: 10px;
  color: #007bff;
  flex-shrink: 0;
}

/* é€‰é¡¹å†…å®¹æ ·å¼ - å…³é”®ä¿®å¤ */
.option-content {
  flex: 1;
  line-height: 1.6;
  /* è®©å†…å®¹åŒºåŸŸä¹Ÿå¯ç‚¹å‡»ï¼Œä½†é˜»æ­¢å†…éƒ¨å…ƒç´ å¹²æ‰° */
  cursor: pointer;
  user-select: none;
  position: relative;
  z-index: 1;
}

/* å…³é”®ä¿®å¤ï¼šè®©KaTeXå’Œä»£ç å—ä¸é˜»æ­¢ç‚¹å‡» */
.option-content ::v-deep * {
  pointer-events: none !important;
  user-select: none !important;
}

/* ç‰¹åˆ«å¤„ç† KaTeX å…ƒç´  */
.option-content ::v-deep .katex,
.option-content ::v-deep .katex-display,
.option-content ::v-deep .katex-html {
  pointer-events: none !important;
  position: relative !important;
  z-index: 0 !important;
}

/* ç‰¹åˆ«å¤„ç†ä»£ç å— */
.option-content ::v-deep pre,
.option-content ::v-deep code,
.option-content ::v-deep .hljs {
  pointer-events: none !important;
  user-select: none !important;
  position: relative !important;
  z-index: 0 !important;
}

/* ç¡®ä¿ Radio å’Œ Checkbox çš„æ ·å¼æ­£ç¡® */
::v-deep .el-radio__input,
::v-deep .el-checkbox__input {
  position: absolute;
  left: 0;
  top: 50%;
  transform: translateY(-50%);
  z-index: 10;
  pointer-events: auto !important;
}

::v-deep .el-radio__label,
::v-deep .el-checkbox__label {
  width: 100%;
  padding-left: 30px;
}

/* é€‰ä¸­çŠ¶æ€æ ·å¼ */
::v-deep .el-radio__input.is-checked + .el-radio__label .option-wrapper,
::v-deep .el-checkbox__input.is-checked + .el-checkbox__label .option-wrapper {
  background: #e7f3ff;
  border: 2px solid #409eff;
}
&lt;/style&gt;</pre>
            </div>

            <div class="step">
                <span class="step-number">4</span>
                <strong>é¢å¤–çš„JavaScriptå¢å¼ºï¼ˆå¯é€‰ï¼‰</strong>
            </div>
            
            <div class="code-block">
                <pre>// åœ¨ mounted é’©å­ä¸­æ·»åŠ å…¨å±€ç‚¹å‡»äº‹ä»¶ç›‘å¬
mounted() {
  this.init();
  
  // æ·»åŠ å…¨å±€äº‹ä»¶å§”æ‰˜ï¼Œç¡®ä¿é€‰é¡¹å¯ç‚¹å‡»
  this.$nextTick(() => {
    this.setupOptionClickHandlers();
  });
},

methods: {
  setupOptionClickHandlers() {
    // ä½¿ç”¨äº‹ä»¶å§”æ‰˜å¤„ç†åŠ¨æ€æ¸²æŸ“çš„å†…å®¹
    const container = this.$el.querySelector('.choice-options');
    if (container) {
      container.addEventListener('click', (e) => {
        // æŸ¥æ‰¾æœ€è¿‘çš„é€‰é¡¹å…ƒç´ 
        const optionEl = e.target.closest('.option-wrapper');
        if (optionEl) {
          // è·å–é€‰é¡¹çš„key
          const radioEl = optionEl.closest('.el-radio') || optionEl.closest('.el-checkbox');
          if (radioEl) {
            const key = radioEl.querySelector('input').value;
            if (key) {
              // æ¨¡æ‹Ÿç‚¹å‡»äº‹ä»¶
              radioEl.querySelector('input').click();
            }
          }
        }
      }, true); // ä½¿ç”¨æ•è·é˜¶æ®µ
    }
  },
  
  // ... å…¶ä»–æ–¹æ³•
}</pre>
            </div>

            <div class="step">
                <span class="step-number">5</span>
                <strong>æ„å»ºå’Œéƒ¨ç½²</strong>
            </div>
            
            <div class="code-block">
                <pre># é‡æ–°æ„å»ºé¡¹ç›®
NODE_OPTIONS="--openssl-legacy-provider" npm run build

# æˆ–è€…åœ¨å¼€å‘æ¨¡å¼ä¸‹æµ‹è¯•
NODE_OPTIONS="--openssl-legacy-provider" npm run serve

# æ¸…é™¤ç¼“å­˜ï¼ˆå¦‚æœéœ€è¦ï¼‰
rm -rf node_modules/.cache
npm cache clean --force</pre>
            </div>
        </div>

        <div class="important">
            <h3>ğŸ¯ æµ‹è¯•è¦ç‚¹</h3>
            <ol>
                <li><strong>å•é€‰é¢˜æµ‹è¯•ï¼š</strong>ç‚¹å‡»é€‰é¡¹çš„ä»»ä½•ä½ç½®éƒ½åº”è¯¥èƒ½é€‰ä¸­</li>
                <li><strong>å¤šé€‰é¢˜æµ‹è¯•ï¼š</strong>èƒ½å¤Ÿå¤šé€‰å’Œå–æ¶ˆé€‰æ‹©</li>
                <li><strong>æ•°å­¦å…¬å¼é€‰é¡¹ï¼š</strong>ç‚¹å‡»KaTeXæ¸²æŸ“çš„å…¬å¼åº”è¯¥èƒ½é€‰ä¸­é€‰é¡¹</li>
                <li><strong>ä»£ç å—é€‰é¡¹ï¼š</strong>ç‚¹å‡»ä»£ç å—åº”è¯¥èƒ½é€‰ä¸­é€‰é¡¹</li>
                <li><strong>æ··åˆå†…å®¹ï¼š</strong>åŒ…å«æ–‡å­—ã€å…¬å¼å’Œä»£ç çš„é€‰é¡¹éƒ½åº”è¯¥å¯ç‚¹å‡»</li>
            </ol>
        </div>

        <div class="solution-section">
            <h2>ğŸ” è°ƒè¯•æŠ€å·§</h2>
            <p>å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•è°ƒè¯•ï¼š</p>
            <div class="code-block">
                <pre>// åœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œ
// 1. æ£€æŸ¥é€‰é¡¹å…ƒç´ 
document.querySelectorAll('.option-wrapper').forEach(el => {
  el.style.border = '2px solid red';
  el.addEventListener('click', () => console.log('Option clicked!'));
});

// 2. æ£€æŸ¥æ˜¯å¦æœ‰å…ƒç´ é®æŒ¡
document.querySelectorAll('.option-content *').forEach(el => {
  console.log(el.tagName, window.getComputedStyle(el).pointerEvents);
});

// 3. å¼ºåˆ¶ä¿®å¤pointer-events
document.querySelectorAll('.option-content *').forEach(el => {
  el.style.pointerEvents = 'none';
});</pre>
            </div>
        </div>

        <div class="important">
            <h3>ğŸ’¡ æ ¸å¿ƒè§£å†³æ–¹æ¡ˆæ€»ç»“</h3>
            <p>è¿™ä¸ªä¿®å¤æ–¹æ¡ˆçš„æ ¸å¿ƒæ˜¯ï¼š</p>
            <ol>
                <li><span class="highlight">ä½¿ç”¨ pointer-events: none</span> è®©é€‰é¡¹å†…å®¹çš„å­å…ƒç´ ä¸æ‹¦æˆªç‚¹å‡»</li>
                <li><span class="highlight">æ·»åŠ æ˜¾å¼çš„ç‚¹å‡»äº‹ä»¶å¤„ç†</span>ï¼Œç¡®ä¿ç‚¹å‡»ä»»ä½•ä½ç½®éƒ½èƒ½é€‰ä¸­</li>
                <li><span class="highlight">ä½¿ç”¨äº‹ä»¶å§”æ‰˜</span>å¤„ç†åŠ¨æ€æ¸²æŸ“çš„å†…å®¹</li>
                <li><span class="highlight">æ­£ç¡®çš„z-indexå±‚çº§</span>ç¡®ä¿Radio/Checkboxå§‹ç»ˆå¯ç‚¹å‡»</li>
                <li><span class="highlight">@click.native å’Œ @click.stop.prevent</span> çš„ç»„åˆä½¿ç”¨</li>
            </ol>
        </div>
    </div>
</body>
</html>