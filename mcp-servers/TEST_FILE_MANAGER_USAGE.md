# 测试文件管理 MCP 服务器使用指南

## 概述

测试文件管理 MCP 服务器是一个自动化工具，用于检测、管理和组织项目中的测试文件。它可以自动识别根目录下的测试相关文件，并将它们移动到专门的 `TestCode` 目录中，保持项目结构的整洁。

## 功能特性

### 🔍 智能检测
- 自动识别测试文件模式
- 支持多种文件类型（.py, .js, .html, .json, .txt）
- 识别常见测试文件命名规范

### 📁 自动管理
- 自动创建 TestCode 目录
- 安全移动文件（自动备份冲突文件）
- 保持文件权限和时间戳

### 📊 状态监控
- 实时查看 TestCode 目录状态
- 详细的操作结果报告
- 文件大小和修改时间信息

## 支持的测试文件模式

服务器会自动识别以下模式的文件：

- `test_*.py` - 以 test_ 开头的 Python 文件
- `*_test.py` - 以 _test 结尾的 Python 文件
- `*test*.py` - 包含 test 的 Python 文件
- `debug_*.py` - 以 debug_ 开头的调试文件
- `check_*.py` - 以 check_ 开头的检查文件
- `assign_*.py` - 以 assign_ 开头的分配文件
- `*.test.js` - 测试 JavaScript 文件
- 同样的模式适用于 .js, .html, .json, .txt 文件

## 可用指令

### 1. 检测测试文件
```
检测根目录下的测试文件
```
- 扫描根目录中的所有测试相关文件
- 显示文件名、大小和修改时间
- 不执行任何移动操作

### 2. 移动测试文件
```
移动测试文件到TestCode目录
```
- 将检测到的测试文件移动到 TestCode 目录
- 自动处理文件名冲突（创建备份）
- 显示详细的移动结果

### 3. 查看TestCode状态
```
获取TestCode目录状态
```
- 显示 TestCode 目录的基本信息
- 列出目录中的所有文件
- 显示总文件数和总大小

### 4. 清理根目录测试文件
```
清理根目录下的所有测试文件
```
- 一键清理根目录中的所有测试文件
- 自动移动到 TestCode 目录
- 提供完整的操作报告

### 5. 确保TestCode目录存在
```
确保TestCode目录存在
```
- 检查并创建 TestCode 目录
- 显示目录路径信息

## 使用示例

### 场景1：项目初始化
当开始一个新项目或需要整理现有项目时：

1. 首先检测现有的测试文件：
   ```
   检测根目录下的测试文件
   ```

2. 查看检测结果，然后清理根目录：
   ```
   清理根目录下的所有测试文件
   ```

### 场景2：日常开发
在日常开发过程中，当创建了新的测试文件：

1. 移动新创建的测试文件：
   ```
   移动测试文件到TestCode目录
   ```

2. 查看TestCode目录状态：
   ```
   获取TestCode目录状态
   ```

### 场景3：项目维护
定期整理和维护测试文件：

1. 检测是否有新的测试文件：
   ```
   检测根目录下的测试文件
   ```

2. 如果有新文件，进行清理：
   ```
   清理根目录下的所有测试文件
   ```

## 安全特性

### 文件冲突处理
- 当目标位置已存在同名文件时，自动创建带时间戳的备份
- 备份文件格式：`原文件名.backup.YYYY-MM-DDTHH-MM-SS-sssZ`
- 确保不会丢失任何数据

### 错误处理
- 详细的错误信息和状态报告
- 操作失败时提供具体的失败原因
- 部分失败不影响其他文件的处理

### 权限保护
- 保持原文件的权限设置
- 只在工作目录范围内操作
- 不会修改系统关键文件

## 目录结构

使用测试文件管理器后，项目结构将变为：

```
/home/metaspeekoj/
├── OnlineJudge/          # 后端项目
├── OnlineJudgeFE/        # 前端项目
├── TestCode/             # 测试文件目录
│   ├── test_api.py
│   ├── test_choice_questions.html
│   ├── debug_questions.py
│   ├── check_questions.py
│   └── ...
├── mcp-servers/          # MCP服务器
└── 其他项目文件...
```

## 技术实现

### 文件检测算法
- 使用正则表达式模式匹配
- 支持大小写不敏感匹配
- 可扩展的文件类型支持

### 移动策略
- 使用原子操作确保数据安全
- 先备份后移动的安全策略
- 保持文件元数据完整性

### 性能优化
- 批量处理多个文件
- 最小化磁盘I/O操作
- 内存友好的文件处理

## 故障排除

### 常见问题

1. **权限不足**
   - 确保对根目录和TestCode目录有读写权限
   - 检查文件所有者和权限设置

2. **磁盘空间不足**
   - 检查目标目录的可用空间
   - 清理不必要的备份文件

3. **文件被占用**
   - 确保文件没有被其他程序打开
   - 关闭相关的编辑器或IDE

### 恢复操作

如需恢复移动的文件：
```bash
# 手动移动文件回根目录
mv /home/metaspeekoj/TestCode/文件名 /home/metaspeekoj/

# 或批量移动
mv /home/metaspeekoj/TestCode/* /home/metaspeekoj/
```

## 最佳实践

1. **定期清理**：建议每周运行一次清理操作
2. **备份重要文件**：移动重要测试文件前先手动备份
3. **命名规范**：遵循标准的测试文件命名规范
4. **文档记录**：在TestCode目录中添加README说明文件用途

## 版本信息

- **版本**：1.0.0
- **兼容性**：Node.js 14.0.0+
- **支持平台**：Linux, macOS, Windows
- **最后更新**：2024年

---

通过使用测试文件管理 MCP 服务器，您可以轻松保持项目结构的整洁，提高开发效率，并确保测试文件的有序管理。