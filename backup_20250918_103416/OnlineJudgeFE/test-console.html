<!DOCTYPE html>
<html>
<head>
    <title>Console Debug Test</title>
    <meta charset="utf-8">
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .console-output { 
            background: #000; 
            color: #0f0; 
            padding: 10px; 
            font-family: monospace; 
            height: 400px; 
            overflow-y: auto; 
            border: 1px solid #ccc;
            margin-top: 10px;
        }
        .btn { 
            background: #007bff; 
            color: white; 
            padding: 10px 20px; 
            border: none; 
            cursor: pointer; 
            margin: 5px;
        }
    </style>
</head>
<body>
    <h1>控制台调试测试</h1>
    <p>点击按钮跳转到目标页面并监听控制台输出：</p>
    
    <button class="btn" onclick="goToTarget()">跳转到 /topics/4/practice</button>
    <button class="btn" onclick="clearConsole()">清空控制台</button>
    
    <div class="console-output" id="console"></div>
    
    <script>
        const consoleDiv = document.getElementById('console');
        
        // 重写console方法来捕获输出
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;
        
        function addToConsole(type, ...args) {
            const timestamp = new Date().toLocaleTimeString();
            const message = args.map(arg => 
                typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)
            ).join(' ');
            
            const div = document.createElement('div');
            div.innerHTML = `[${timestamp}] [${type.toUpperCase()}] ${message}`;
            consoleDiv.appendChild(div);
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addToConsole('log', ...args);
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addToConsole('error', ...args);
        };
        
        console.warn = function(...args) {
            originalWarn.apply(console, args);
            addToConsole('warn', ...args);
        };
        
        function goToTarget() {
            console.log('准备跳转到目标页面...');
            window.location.href = '/topics/4/practice';
        }
        
        function clearConsole() {
            consoleDiv.innerHTML = '';
        }
        
        // 捕获错误
        window.addEventListener('error', function(e) {
            console.error('页面错误:', e.error?.message || e.message);
        });
        
        console.log('控制台调试页面已加载');
    </script>
</body>
</html>